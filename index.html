<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>„ÉÄ„É≥„ÇπÁ∑¥Áøí„Ç¢„Éó„É™Ôºà„Éó„É¨„Éì„É•„Éº„Å™„ÅóÁâàÔºâ</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            overflow: hidden;
        }
        * {
            box-sizing: border-box;
        }
        
        .landscape-mode {
            width: 100vw;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
        }
        
        @media screen and (orientation: portrait) {
            .landscape-mode {
                transform: rotate(90deg);
                transform-origin: left top;
                width: 100vh;
                height: 100vw;
                overflow-x: hidden;
                position: absolute;
                top: 100%;
                left: 0;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // SVG„Ç¢„Ç§„Ç≥„É≥
        const Play = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>);
        const Pause = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></svg>);
        const RotateCcw = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="1 4 1 10 7 10"></polyline><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path></svg>);
        const Smartphone = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect><line x1="12" y1="18" x2="12.01" y2="18"></line></svg>);
        const Camera = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>);
        const Maximize = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path></svg>);
        const Film = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"></rect><line x1="7" y1="2" x2="7" y2="22"></line><line x1="17" y1="2" x2="17" y2="22"></line></svg>);
        const Wifi = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M5 12.55a11 11 0 0 1 14.08 0"></path><path d="M1.42 9a16 16 0 0 1 21.16 0"></path></svg>);
        const CheckCircle = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>);

        const DancePracticeApp = () => {
            const [mode, setMode] = useState('select');
            const [roomCode, setRoomCode] = useState('');
            const [inputRoomCode, setInputRoomCode] = useState('');
            const [videoFile, setVideoFile] = useState(null);
            const [videoUrl, setVideoUrl] = useState('');
            const [isPlaying, setIsPlaying] = useState(false);
            const [connectionError, setConnectionError] = useState('');
            const [cameraConnected, setCameraConnected] = useState(false);
            const [showDisplay, setShowDisplay] = useState(false);
            
            const displayVideoRef = useRef(null);
            const cameraVideoRef = useRef(null);
            const canvasRef = useRef(null);
            const streamIntervalRef = useRef(null);
            const channelRef = useRef(null);

            // ÈÄö‰ø°
            useEffect(() => {
                if (roomCode && (mode === 'main' || mode === 'camera')) {
                    channelRef.current = new BroadcastChannel(`dance-${roomCode}`);
                    channelRef.current.onmessage = (e) => handleMessage(e.data);
                    return () => channelRef.current?.close();
                }
            }, [mode, roomCode]);

            const sendMessage = (data) => {
                if (channelRef.current) {
                    channelRef.current.postMessage({ ...data, roomCode });
                }
            };

            const handleMessage = (data) => {
                if (!data) return;
                
                if (data.type === 'play') {
                    setIsPlaying(true);
                    displayVideoRef.current?.play?.().catch(e => console.log('Play error:', e));
                } else if (data.type === 'pause') {
                    setIsPlaying(false);
                    displayVideoRef.current?.pause?.();
                } else if (data.type === 'reset') {
                    setIsPlaying(false);
                    if (displayVideoRef.current) {
                        displayVideoRef.current.currentTime = 0;
                        displayVideoRef.current.pause();
                    }
                } else if (data.type === 'camera-connect') {
                    setCameraConnected(true);
                } else if (data.type === 'camera-frame' && canvasRef.current) {
                    const img = new Image();
                    img.onload = () => {
                        const ctx = canvasRef.current.getContext('2d');
                        canvasRef.current.width = img.width;
                        canvasRef.current.height = img.height;
                        ctx.save();
                        ctx.scale(-1, 1);
                        ctx.drawImage(img, -img.width, 0);
                        ctx.restore();
                    };
                    img.src = data.frame;
                }
            };

            const generateRoomCode = () => Math.random().toString(36).substring(2, 8).toUpperCase();

            const handleVideoSelect = (e) => {
                const file = e.target.files[0];
                if (file && file.type.startsWith('video/')) {
                    setVideoFile(file);
                    // „Éó„É¨„Éì„É•„Éº„ÅØ‰ΩúÊàê„Åó„Å™„ÅÑÔºà„Éï„É™„Éº„Ç∫Èò≤Ê≠¢Ôºâ
                    // ÂÖ®ÁîªÈù¢Ë°®Á§∫ÊôÇ„ÅÆ„ÅøURL„Çí‰ΩúÊàê
                }
            };

            const togglePlay = () => {
                sendMessage({ type: isPlaying ? 'pause' : 'play' });
                if (displayVideoRef.current) {
                    if (isPlaying) {
                        displayVideoRef.current.pause();
                    } else {
                        displayVideoRef.current.play().catch(e => console.log('Play error:', e));
                    }
                }
                setIsPlaying(!isPlaying);
            };

            const resetVideo = () => {
                sendMessage({ type: 'reset' });
                if (displayVideoRef.current) {
                    displayVideoRef.current.currentTime = 0;
                    displayVideoRef.current.pause();
                }
                setIsPlaying(false);
            };

            const enterDisplayMode = () => {
                if (videoFile) {
                    // ÂÖ®ÁîªÈù¢Ë°®Á§∫„Å´ÂÖ•„ÇãÊôÇ„Å†„ÅëURL„Çí‰ΩúÊàê
                    setVideoUrl(URL.createObjectURL(videoFile));
                    setShowDisplay(true);
                }
            };

            // „Ç´„É°„É©ÈÄÅ‰ø°
            useEffect(() => {
                if (mode === 'camera' && cameraVideoRef.current && roomCode) {
                    navigator.mediaDevices.getUserMedia({ 
                        video: { facingMode: 'user', width: { ideal: 640 }, height: { ideal: 480 } }
                    })
                    .then(stream => {
                        cameraVideoRef.current.srcObject = stream;
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        let count = 0;
                        
                        streamIntervalRef.current = setInterval(() => {
                            if (cameraVideoRef.current?.readyState === 4 && count++ % 6 === 0) {
                                canvas.width = cameraVideoRef.current.videoWidth;
                                canvas.height = cameraVideoRef.current.videoHeight;
                                ctx.drawImage(cameraVideoRef.current, 0, 0);
                                sendMessage({ 
                                    type: 'camera-frame', 
                                    frame: canvas.toDataURL('image/jpeg', 0.3)
                                });
                            }
                        }, 250);
                    })
                    .catch(() => alert('„Ç´„É°„É©„Å∏„ÅÆ„Ç¢„ÇØ„Çª„Çπ„ÇíË®±ÂèØ„Åó„Å¶„Åè„Å†„Åï„ÅÑ'));

                    return () => {
                        clearInterval(streamIntervalRef.current);
                        cameraVideoRef.current?.srcObject?.getTracks().forEach(t => t.stop());
                    };
                }
            }, [mode, roomCode]);

            // „É¢„Éº„ÉâÈÅ∏Êäû
            if (mode === 'select') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center p-4">
                        <div className="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full">
                            <div className="text-center mb-8">
                                <h1 className="text-4xl font-bold text-gray-800 mb-2">üï∫ „ÉÄ„É≥„ÇπÁ∑¥Áøí</h1>
                                <p className="text-sm text-green-600 font-semibold">‚úÖ „Éó„É¨„Éì„É•„Éº„Å™„ÅóÁâà</p>
                                <p className="text-xs text-gray-500 mt-1">Â§ß„Åç„Å™ÂãïÁîª„ÇÇOKÔºÅ</p>
                            </div>
                            
                            <div className="space-y-4">
                                <button onClick={() => { setRoomCode(generateRoomCode()); setMode('main'); }}
                                    className="w-full bg-blue-500 hover:bg-blue-600 text-white rounded-xl p-6 flex items-center justify-between transition-transform transform hover:scale-105">
                                    <div className="flex items-center gap-4">
                                        <div className="w-8 h-8"><Smartphone /></div>
                                        <div className="text-left">
                                            <div className="font-bold text-lg">üì± „Çπ„Éû„ÉõA</div>
                                            <div className="text-sm opacity-90">Êìç‰Ωú + Ë°®Á§∫</div>
                                        </div>
                                    </div>
                                    <div className="text-2xl">‚Üí</div>
                                </button>

                                <button onClick={() => setMode('camera-input')}
                                    className="w-full bg-pink-500 hover:bg-pink-600 text-white rounded-xl p-6 flex items-center justify-between transition-transform transform hover:scale-105">
                                    <div className="flex items-center gap-4">
                                        <div className="w-8 h-8"><Camera /></div>
                                        <div className="text-left">
                                            <div className="font-bold text-lg">üì± „Çπ„Éû„ÉõB</div>
                                            <div className="text-sm opacity-90">„Ç´„É°„É©</div>
                                        </div>
                                    </div>
                                    <div className="text-2xl">‚Üí</div>
                                </button>
                            </div>

                            <div className="mt-8 pt-6 border-t border-gray-200">
                                <div className="bg-green-50 border border-green-200 rounded-xl p-3 text-xs text-gray-700">
                                    <strong>‚úÖ ÁâπÂæ¥:</strong><br/>
                                    ‚Ä¢ „Éó„É¨„Éì„É•„Éº„Å™„ÅóÔºà„Éï„É™„Éº„Ç∫Èò≤Ê≠¢Ôºâ<br/>
                                    ‚Ä¢ ÂÖ®ÁîªÈù¢Ë°®Á§∫„ÅßÂãïÁîª„ÇíÂÜçÁîü<br/>
                                    ‚Ä¢ Â§ß„Åç„Å™ÂãïÁîª„ÇÇ„Çµ„ÇØ„Çµ„ÇØÂãï‰Ωú
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            // „É°„Ç§„É≥ÁîªÈù¢
            if (mode === 'main') {
                if (showDisplay) {
                    return (
                        <div className="landscape-mode">
                            <div className="w-full h-full bg-black flex">
                                <div className="w-1/2 bg-gray-900 flex items-center justify-center relative">
                                    {videoUrl ? (
                                        <>
                                            <video 
                                                ref={displayVideoRef} 
                                                src={videoUrl} 
                                                className="max-w-full max-h-full" 
                                                loop 
                                                playsInline 
                                                preload="auto"
                                            />
                                            <div className="absolute top-6 left-6 bg-purple-500 text-white px-6 py-3 rounded-full font-bold text-xl shadow-lg">
                                                üë®‚Äçüè´ Ë¶ãÊú¨
                                            </div>
                                        </>
                                    ) : (
                                        <p className="text-white text-xl">ÂãïÁîª„ÇíË™≠„ÅøËæº„Åø‰∏≠...</p>
                                    )}
                                </div>

                                <div className="w-1/2 bg-black flex items-center justify-center relative">
                                    <canvas ref={canvasRef} className="w-full h-full object-contain" />
                                    {!cameraConnected && (
                                        <div className="absolute text-center text-white">
                                            <div className="w-20 h-20 mx-auto mb-4 opacity-50"><Camera /></div>
                                            <p className="text-xl mb-2">„Çπ„Éû„ÉõBÊé•Á∂öÂæÖ„Å°...</p>
                                            <p className="text-sm text-gray-400">„É´„Éº„É†„Ç≥„Éº„Éâ: {roomCode}</p>
                                        </div>
                                    )}
                                    <div className="absolute top-6 right-6 bg-pink-500 text-white px-6 py-3 rounded-full font-bold text-xl shadow-lg">
                                        üé• „ÅÇ„Å™„Åü
                                    </div>
                                    {cameraConnected && (
                                        <div className="absolute bottom-6 right-6 flex items-center gap-3 bg-black/70 text-white px-4 py-2 rounded-full">
                                            <div className="w-5 h-5"><Camera /></div>
                                            <span className="text-sm">„Çπ„Éû„ÉõBÊé•Á∂ö‰∏≠</span>
                                        </div>
                                    )}
                                    <button onClick={() => { setShowDisplay(false); setVideoUrl(''); }} 
                                        className="absolute top-6 left-6 bg-gray-700/80 hover:bg-gray-600 text-white px-4 py-2 rounded-full text-sm">
                                        ‚úï Êàª„Çã
                                    </button>
                                </div>
                            </div>
                        </div>
                    );
                }

                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-500 to-cyan-500 p-4">
                        <div className="max-w-md mx-auto">
                            <div className="bg-white rounded-3xl shadow-2xl p-6 mb-4">
                                <div className="flex items-center justify-between mb-4">
                                    <h2 className="text-2xl font-bold text-gray-800">üì± „Çπ„Éû„ÉõA</h2>
                                    <button onClick={() => setMode('select')} className="text-gray-500 hover:text-gray-700 text-2xl">‚úï</button>
                                </div>

                                <div className="bg-gradient-to-r from-purple-100 to-pink-100 rounded-2xl p-6 mb-6">
                                    <div className="text-center">
                                        <div className="text-sm text-gray-600 mb-2">„É´„Éº„É†„Ç≥„Éº„Éâ</div>
                                        <div className="text-4xl font-bold text-purple-700 tracking-widest mb-2">{roomCode}</div>
                                        <div className="text-xs text-gray-600">„Çπ„Éû„ÉõB„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>
                                    </div>
                                </div>

                                {!videoFile ? (
                                    <div className="border-4 border-dashed border-gray-300 rounded-2xl p-8 text-center mb-4">
                                        <div className="w-16 h-16 mx-auto mb-4 text-gray-400"><Film /></div>
                                        <p className="text-gray-600 mb-2 font-semibold">„Ç´„É°„É©„É≠„Éº„É´„Åã„ÇâÈÅ∏Êäû</p>
                                        <p className="text-xs text-green-600 mb-4">‚úÖ „Å©„Çì„Å™„Çµ„Ç§„Ç∫„Åß„ÇÇOKÔºÅ</p>
                                        <label className="bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-xl cursor-pointer inline-block transition-transform transform hover:scale-105">
                                            ÂãïÁîª„ÇíÈÅ∏Êäû
                                            <input type="file" accept="video/*" onChange={handleVideoSelect} className="hidden" />
                                        </label>
                                    </div>
                                ) : (
                                    <div>
                                        <div className="bg-gradient-to-r from-green-50 to-blue-50 border-2 border-green-300 rounded-2xl p-6 mb-4">
                                            <div className="flex items-center gap-3 mb-3">
                                                <div className="w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center text-white">
                                                    <CheckCircle />
                                                </div>
                                                <div className="flex-1">
                                                    <div className="font-bold text-green-700 mb-1">ÂãïÁîª„ÅåÈÅ∏Êäû„Åï„Çå„Åæ„Åó„ÅüÔºÅ</div>
                                                    <div className="text-sm text-gray-700 font-semibold">{videoFile.name}</div>
                                                    <div className="text-xs text-gray-500">{(videoFile.size / 1024 / 1024).toFixed(1)} MB</div>
                                                </div>
                                            </div>
                                            <div className="bg-yellow-50 border border-yellow-300 rounded-lg p-3 text-xs text-gray-700">
                                                üí° ÂãïÁîª„ÅØ„ÄåÂÖ®ÁîªÈù¢Ë°®Á§∫„Äç„Çí„Çø„ÉÉ„Éó„Åô„Çã„Å®ÂÜçÁîü„Åï„Çå„Åæ„Åô
                                            </div>
                                        </div>

                                        <div className="grid grid-cols-3 gap-3 mb-4">
                                            <button onClick={togglePlay} 
                                                className={`${isPlaying ? 'bg-orange-500 hover:bg-orange-600' : 'bg-green-500 hover:bg-green-600'} text-white rounded-xl p-4 flex flex-col items-center gap-2 transition-transform transform hover:scale-105`}>
                                                <div className="w-8 h-8">{isPlaying ? <Pause /> : <Play />}</div>
                                                <span className="text-xs font-semibold">{isPlaying ? 'ÂÅúÊ≠¢' : 'ÂÜçÁîü'}</span>
                                            </button>

                                            <button onClick={resetVideo} 
                                                className="bg-blue-500 hover:bg-blue-600 text-white rounded-xl p-4 flex flex-col items-center gap-2 transition-transform transform hover:scale-105">
                                                <div className="w-8 h-8"><RotateCcw /></div>
                                                <span className="text-xs font-semibold">ÊúÄÂàù„Åã„Çâ</span>
                                            </button>

                                            <label className="bg-purple-500 hover:bg-purple-600 text-white rounded-xl p-4 flex flex-col items-center gap-2 cursor-pointer transition-transform transform hover:scale-105">
                                                <div className="w-8 h-8"><Film /></div>
                                                <span className="text-xs font-semibold">Â§âÊõ¥</span>
                                                <input type="file" accept="video/*" onChange={handleVideoSelect} className="hidden" />
                                            </label>
                                        </div>

                                        <button onClick={enterDisplayMode}
                                            className="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white rounded-xl p-5 flex items-center justify-center gap-3 mb-4 transition-transform transform hover:scale-105 shadow-lg">
                                            <div className="w-6 h-6"><Maximize /></div>
                                            <span className="font-bold text-lg">ÂÖ®ÁîªÈù¢Ë°®Á§∫ÔºàÊ®™Âêë„ÅçÔºâ</span>
                                        </button>
                                    </div>
                                )}
                            </div>

                            <div className="bg-white/90 rounded-2xl p-4 mb-4">
                                <div className="flex items-center justify-center gap-2 text-sm text-gray-600 mb-3">
                                    <div className="w-4 h-4"><Wifi /></div>
                                    <span>Êé•Á∂öÁä∂ÊÖã</span>
                                </div>
                                <div className={`p-3 rounded-lg text-center text-sm ${cameraConnected ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-500'}`}>
                                    üì± „Çπ„Éû„ÉõBÔºà„Ç´„É°„É©Ôºâ {cameraConnected ? '‚úì Êé•Á∂öÊ∏à„Åø' : 'ÂæÖÊ©ü‰∏≠...'}
                                </div>
                            </div>

                            <div className="bg-blue-50 border border-blue-200 rounded-2xl p-4 text-sm text-gray-700">
                                <strong>üì∫ ‰Ωø„ÅÑÊñπ:</strong><br/>
                                1. ÂãïÁîª„ÇíÈÅ∏Êäû<br/>
                                2. „ÄåÂÖ®ÁîªÈù¢Ë°®Á§∫„Äç„Çí„Çø„ÉÉ„Éó<br/>
                                3. AirPlay„Åß„ÉÜ„É¨„Éì„Å´Êé•Á∂ö<br/>
                                4. Ê®™Âêë„Åç„ÅßÂ§ßÁîªÈù¢Ë°®Á§∫ÔºÅ
                            </div>
                        </div>
                    </div>
                );
            }

            // „Ç´„É°„É©ÂÖ•Âäõ
            if (mode === 'camera-input') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-pink-500 to-rose-500 flex items-center justify-center p-8">
                        <div className="bg-white rounded-3xl shadow-2xl p-12 max-w-lg w-full">
                            <div className="text-center mb-8">
                                <div className="w-20 h-20 mx-auto mb-4 text-pink-500"><Camera /></div>
                                <h2 className="text-3xl font-bold text-gray-800 mb-2">üì± „Çπ„Éû„ÉõBÔºà„Ç´„É°„É©Ôºâ</h2>
                                <p className="text-gray-600">„Çπ„Éû„ÉõA„ÅÆ„É´„Éº„É†„Ç≥„Éº„Éâ„ÇíÂÖ•Âäõ</p>
                            </div>

                            <div className="space-y-4">
                                <input type="text" placeholder="ABC123" value={inputRoomCode}
                                    onChange={(e) => { setInputRoomCode(e.target.value.toUpperCase()); setConnectionError(''); }}
                                    maxLength={6}
                                    className="w-full text-center text-3xl font-bold tracking-widest border-4 border-gray-300 rounded-2xl p-6 focus:outline-none focus:border-pink-500 uppercase" />

                                {connectionError && <div className="bg-red-100 text-red-700 rounded-xl p-4 text-center">{connectionError}</div>}

                                <button onClick={() => {
                                    if (inputRoomCode.length === 6) {
                                        setRoomCode(inputRoomCode.toUpperCase());
                                        setMode('camera');
                                        setTimeout(() => sendMessage({ type: 'camera-connect' }), 500);
                                    } else {
                                        setConnectionError('6ÊñáÂ≠ó„ÅÆ„É´„Éº„É†„Ç≥„Éº„Éâ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                                    }
                                }}
                                    disabled={inputRoomCode.length !== 6}
                                    className="w-full bg-pink-500 hover:bg-pink-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-white rounded-2xl p-6 text-xl font-bold transition-transform transform hover:scale-105 disabled:transform-none">
                                    „Ç´„É°„É©„Å®„Åó„Å¶Êé•Á∂ö
                                </button>

                                <button onClick={() => { setMode('select'); setInputRoomCode(''); setConnectionError(''); }}
                                    className="w-full bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-2xl p-4 transition-all">
                                    Êàª„Çã
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // „Ç´„É°„É©ÁîªÈù¢
            if (mode === 'camera') {
                return (
                    <div className="min-h-screen bg-black flex flex-col">
                        <div className="flex-1 relative flex items-center justify-center">
                            <video ref={cameraVideoRef} autoPlay playsInline muted 
                                className="w-full h-full object-cover" style={{ transform: 'scaleX(-1)' }} />
                            <div className="absolute top-6 left-6 bg-pink-500 text-white px-6 py-3 rounded-full font-bold text-xl shadow-lg">
                                üì± „Ç´„É°„É©Ëµ∑Âãï‰∏≠
                            </div>
                            <div className="absolute bottom-6 left-6 right-6">
                                <div className="bg-black/70 text-white rounded-2xl p-4">
                                    <div className="flex items-center justify-between mb-2">
                                        <span className="text-sm">„É´„Éº„É†„Ç≥„Éº„Éâ</span>
                                        <span className="font-bold text-lg tracking-wider">{roomCode}</span>
                                    </div>
                                    <div className="flex items-center gap-2 text-sm text-green-400">
                                        <div className="w-3 h-3 bg-green-400 rounded-full animate-pulse"></div>
                                        <span>Êò†ÂÉè„ÇíÈÄÅ‰ø°‰∏≠...</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            return null;
        };

        ReactDOM.render(<DancePracticeApp />, document.getElementById('root'));
    </script>
</body>
</html>
